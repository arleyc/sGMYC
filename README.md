
<!-- README.md is generated from README.Rmd. Please edit that file -->

# sGMYC: GMYC analysis with subsampling

<!-- badges: start -->
<!-- badges: end -->

sGMYC runs a single-threshold GMYC analysis (Pons et al. 2006) using the
splits package (Fujisawa & Barraclough 2013) with subsamples of
sequences obtained from within the species delimited using all
sequences. It also plots a heatmap of conspecificity probabilities among
samples based on functions of the bGMYC package (Reid & Carstens 2012).
When more than one tree are provided, sGMYC can implement the analysis
with multiple cores using the parallel and doParallel packages.

## Installation

You can install the development version from
[GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("arleyc/sGMYC")
```

## Example 1: subsampling from one tree

``` r
library(sGMYC)
data("hypotree")
sGMYC(hypotree,nreps=10)
#> node  T   loglik
#> 2 -0.02726699 425.9605 
#> 3 -0.02520101 426.6495 
#> 4 -0.01821008 426.3314 
#> 5 -0.01589382 426.3022 
#> 6 -0.01561988 426.0656 
#> 7 -0.01524027 426.4572 
#> 8 -0.01186139 427.7125 
#> 9 -0.01039614 428.1633 
#> 10 -0.008918372 428.754 
#> 11 -0.007728547 429.6407 
#> 12 -0.006377538 430.3857 
#> 13 -0.006232079 430.5274 
#> 14 -0.005269795 430.362 
#> 15 -0.005243926 429.0368 
#> 16 -0.005065107 428.7704 
#> 17 -0.00492 427.5121 
#> 18 -0.004623495 427.6705 
#> 19 -0.004543043 426.484 
#> 20 -0.004485202 425.6342 
#> 21 -0.004310168 425.7301 
#> 22 -0.003976026 425.8543 
#> 23 -0.003893785 425.783 
#> 24 -0.003864802 425.1069 
#> 25 -0.00332436 424.8521 
#> 26 -0.003054598 424.1604 
#> 27 -0.002872317 424.3716 
#> 28 -0.00275686 424.3434 
#> 29 -0.002711494 425.291 
#> 30 -0.002701228 424.8166 
#> 31 -0.002570061 425.2695 
#> 32 -0.002444037 425.5138 
#> 33 -0.002393119 425.7625 
#> 34 -0.002378823 425.6245 
#> 35 -0.002347473 425.3946 
#> 36 -0.002267578 425.3478 
#> 37 -0.002161588 425.0657 
#> 38 -0.002159941 424.7901 
#> 39 -0.002135154 424.4576 
#> 40 -0.00205472 424.5476 
#> 41 -0.002005334 424.2348 
#> 42 -0.00198981 423.9364 
#> 43 -0.001891232 423.8906 
#> 44 -0.001779119 423.6299 
#> 45 -0.00175497 423.4206 
#> 46 -0.001549319 423.2165 
#> 47 -0.001529425 423.1062 
#> 48 -0.001357459 422.998 
#> 49 -0.001347936 422.9649 
#> 50 -0.001254312 423.2511 
#> 51 -0.001223809 423.3843 
#> 52 -0.001151231 423.669 
#> 53 -0.001027681 423.7947 
#> 54 -0.001015731 423.9942 
#> 55 -0.001000364 424.2126 
#> 56 -0.0009617781 424.4548 
#> 57 -0.0009136881 424.7372 
#> 58 -0.0007194314 425.07 
#> 
#> Sat Sep 28 09:18:02 2024
#> finish.
#> node  T   loglik
#> 2 -0.02726699 126.7056 
#> 3 -0.02520101 126.9874 
#> 4 -0.01821008 126.3657 
#> 5 -0.01589382 126.2412 
#> 6 -0.01561988 125.7911 
#> 7 -0.01524027 125.7616 
#> 8 -0.01186139 125.939 
#> 9 -0.01039614 125.7775 
#> 10 -0.008918372 125.8027 
#> 11 -0.007728547 125.9368 
#> 12 -0.006377538 125.7031 
#> 13 -0.006232079 125.7088 
#> 14 -0.005269795 125.6311 
#> 15 -0.00492 125.5752 
#> 16 -0.003054598 125.5993 
#> 17 -0.00275686 125.5086 
#> 18 -0.002711494 125.4896 
#> 19 -0.00205472 125.5657 
#> 20 -0.00198981 125.6841 
#> 21 -0.001357459 125.9134 
#> 22 -0.001347936 126.2424 
#> 
#> Sat Sep 28 09:18:02 2024
#> finish.
#> node  T   loglik
#> 2 -0.02726699 126.8909 
#> 3 -0.02520101 127.2173 
#> 4 -0.01821008 126.583 
#> 5 -0.01589382 126.5061 
#> 6 -0.01561988 126.0691 
#> 7 -0.01524027 125.9889 
#> 8 -0.01186139 126.1027 
#> 9 -0.01039614 126.0571 
#> 10 -0.008918372 126.2862 
#> 11 -0.007728547 126.2576 
#> 12 -0.006377538 126.2593 
#> 13 -0.006232079 126.0581 
#> 14 -0.004543043 126.0294 
#> 15 -0.003893785 125.923 
#> 16 -0.00332436 125.8429 
#> 17 -0.003054598 125.7952 
#> 18 -0.00205472 125.8202 
#> 19 -0.00198981 125.8197 
#> 20 -0.001891232 125.9319 
#> 21 -0.001529425 126.154 
#> 22 -0.001000364 126.4869 
#> 
#> Sat Sep 28 09:18:02 2024
#> finish.
#> node  T   loglik
#> 2 -0.02726699 126.4478 
#> 3 -0.02520101 126.6821 
#> 4 -0.01821008 126.1771 
#> 5 -0.01589382 126.0935 
#> 6 -0.01561988 125.6974 
#> 7 -0.01524027 125.6002 
#> 8 -0.01186139 125.5727 
#> 9 -0.01039614 125.4404 
#> 10 -0.008918372 125.5005 
#> 11 -0.007728547 125.554 
#> 12 -0.006377538 125.2799 
#> 13 -0.006232079 125.3025 
#> 14 -0.005243926 125.1849 
#> 15 -0.005065107 125.0955 
#> 16 -0.00492 125.051 
#> 17 -0.003893785 125.0918 
#> 18 -0.003054598 125.1772 
#> 19 -0.00205472 125.2921 
#> 20 -0.00198981 125.3941 
#> 21 -0.001347936 125.6238 
#> 22 -0.001151231 125.9303 
#> 
#> Sat Sep 28 09:18:02 2024
#> finish.
#> node  T   loglik
#> 2 -0.02726699 126.5333 
#> 3 -0.02520101 126.7792 
#> 4 -0.01821008 126.2283 
#> 5 -0.01589382 126.0443 
#> 6 -0.01561988 125.4102 
#> 7 -0.01524027 125.4403 
#> 8 -0.01186139 125.7919 
#> 9 -0.01039614 125.5738 
#> 10 -0.008918372 125.5898 
#> 11 -0.007728547 125.6082 
#> 12 -0.006377538 125.4579 
#> 13 -0.005269795 125.4127 
#> 14 -0.005243926 125.2942 
#> 15 -0.005065107 125.2044 
#> 16 -0.00492 125.1561 
#> 17 -0.00332436 125.1934 
#> 18 -0.003054598 125.2239 
#> 19 -0.002378823 125.3265 
#> 20 -0.00205472 125.472 
#> 21 -0.001357459 125.7084 
#> 22 -0.001223809 126.023 
#> 
#> Sat Sep 28 09:18:02 2024
#> finish.
#> node  T   loglik
#> 2 -0.02726699 126.2269 
#> 3 -0.02520101 126.429 
#> 4 -0.01821008 126.0073 
#> 5 -0.01589382 125.8466 
#> 6 -0.01561988 125.454 
#> 7 -0.01524027 125.1407 
#> 8 -0.01186139 125.346 
#> 9 -0.01039614 125.1027 
#> 10 -0.008918372 125.0282 
#> 11 -0.007728547 125.1918 
#> 12 -0.006377538 124.8886 
#> 13 -0.006232079 125.0037 
#> 14 -0.005269795 124.8855 
#> 15 -0.005065107 124.8059 
#> 16 -0.00492 124.7356 
#> 17 -0.004485202 124.7001 
#> 18 -0.004310168 124.7378 
#> 19 -0.002701228 124.8848 
#> 20 -0.00205472 125.0532 
#> 21 -0.00198981 125.2855 
#> 22 -0.001027681 125.6651 
#> 
#> Sat Sep 28 09:18:02 2024
#> finish.
#> node  T   loglik
#> 2 -0.02726699 126.2876 
#> 3 -0.02520101 126.5001 
#> 4 -0.01821008 126.0677 
#> 5 -0.01589382 126.0152 
#> 6 -0.01561988 125.6965 
#> 7 -0.01524027 125.5248 
#> 8 -0.01186139 125.4858 
#> 9 -0.01039614 125.3615 
#> 10 -0.008918372 125.2356 
#> 11 -0.007728547 125.4116 
#> 12 -0.006377538 125.0754 
#> 13 -0.006232079 125.0738 
#> 14 -0.005243926 124.9538 
#> 15 -0.005065107 124.8699 
#> 16 -0.004623495 124.8034 
#> 17 -0.004543043 124.7841 
#> 18 -0.004310168 124.8346 
#> 19 -0.00205472 125.0164 
#> 20 -0.00198981 125.1261 
#> 21 -0.001779119 125.3561 
#> 22 -0.001347936 125.7093 
#> 
#> Sat Sep 28 09:18:02 2024
#> finish.
#> node  T   loglik
#> 2 -0.02726699 126.6532 
#> 3 -0.02520101 126.9211 
#> 4 -0.01821008 126.3345 
#> 5 -0.01589382 126.22 
#> 6 -0.01561988 125.6588 
#> 7 -0.01524027 125.6225 
#> 8 -0.01186139 126.1194 
#> 9 -0.01039614 125.9419 
#> 10 -0.008918372 125.9593 
#> 11 -0.007728547 126.2177 
#> 12 -0.006377538 125.9217 
#> 13 -0.005269795 125.6006 
#> 14 -0.00492 125.4685 
#> 15 -0.004485202 125.3773 
#> 16 -0.004310168 125.3247 
#> 17 -0.003864802 125.3321 
#> 18 -0.002378823 125.4088 
#> 19 -0.00205472 125.4534 
#> 20 -0.00198981 125.5817 
#> 21 -0.001779119 125.8159 
#> 22 -0.001347936 126.1646 
#> 
#> Sat Sep 28 09:18:02 2024
#> finish.
#> node  T   loglik
#> 2 -0.02726699 126.699 
#> 3 -0.02520101 126.9819 
#> 4 -0.01821008 126.3742 
#> 5 -0.01589382 126.3295 
#> 6 -0.01561988 125.941 
#> 7 -0.01524027 125.8649 
#> 8 -0.01186139 125.9648 
#> 9 -0.01039614 125.8002 
#> 10 -0.008918372 125.8142 
#> 11 -0.007728547 125.9469 
#> 12 -0.006377538 125.6643 
#> 13 -0.006232079 125.7059 
#> 14 -0.005243926 125.6253 
#> 15 -0.00492 125.5652 
#> 16 -0.003864802 125.5855 
#> 17 -0.003054598 125.6033 
#> 18 -0.00205472 125.6236 
#> 19 -0.002005334 125.6068 
#> 20 -0.00198981 125.7121 
#> 21 -0.001357459 125.9467 
#> 22 -0.001027681 126.2564 
#> 
#> Sat Sep 28 09:18:02 2024
#> finish.
#> node  T   loglik
#> 2 -0.02726699 126.524 
#> 3 -0.02520101 126.7696 
#> 4 -0.01821008 126.2294 
#> 5 -0.01589382 126.0556 
#> 6 -0.01561988 125.596 
#> 7 -0.01524027 125.4659 
#> 8 -0.01186139 125.5695 
#> 9 -0.01039614 125.4064 
#> 10 -0.008918372 125.5131 
#> 11 -0.007728547 125.5327 
#> 12 -0.006377538 125.3851 
#> 13 -0.006232079 125.4108 
#> 14 -0.005269795 125.3016 
#> 15 -0.005065107 125.2178 
#> 16 -0.004310168 125.1933 
#> 17 -0.00332436 125.2144 
#> 18 -0.002701228 125.2468 
#> 19 -0.002444037 125.3173 
#> 20 -0.00205472 125.4694 
#> 21 -0.001549319 125.7059 
#> 22 -0.001015731 126.0396 
#> 
#> Sat Sep 28 09:18:02 2024
#> finish.
#> node  T   loglik
#> 2 -0.02726699 126.3125 
#> 3 -0.02520101 126.5152 
#> 4 -0.01821008 126.0157 
#> 5 -0.01589382 125.7431 
#> 6 -0.01561988 125.0407 
#> 7 -0.01524027 125.0817 
#> 8 -0.01186139 125.4582 
#> 9 -0.01039614 125.0731 
#> 10 -0.008918372 125.1041 
#> 11 -0.007728547 125.273 
#> 12 -0.006377538 125.0207 
#> 13 -0.005269795 125.0625 
#> 14 -0.005243926 124.99 
#> 15 -0.005065107 124.9141 
#> 16 -0.004623495 124.8419 
#> 17 -0.004310168 124.8123 
#> 18 -0.00332436 124.8385 
#> 19 -0.002701228 124.9383 
#> 20 -0.002378823 125.1117 
#> 21 -0.00205472 125.3728 
#> 22 -0.00198981 125.7461 
#> 
#> Sat Sep 28 09:18:02 2024
#> finish.
#> [1] 1
#> [[1]]
#> [[1]]$`Number of species (first row) and number of replicates (second row)`
#> bootgmyc
#>  3 
#> 10 
#> 
#> 
#> [[2]]
#>      fullGMYC min_bootGMYC max_bootGMYC mean_bootGMYC sd_bootGMYC reps
#> [1,]       13            3            3             3           0   10
#>      subsamples/sp
#> [1,]             2

#Plotting heatmap of conspecificity probabilities
```

``` r
#Species delimitation with subsampling using multiple trees and computer cores

#Plotting heatmap of conspecificity probabilities
```

## References

Fujisawa T & Barraclough TG. 2013. Delimiting species using single-locus
data and the Generalized Mixed Yule Coalescent approach: A revised
method and evaluation on simulated data sets. Systematic Biology
62:707–724, doi: 10.1093/sysbio/syt033

Pons J, Barraclough TG, Gomez-Zurita J, Cardoso A, Duran DP, Hazell S,
Kamoun S, Sumlin WD & Vogler AP. 2006. Sequence-based species
delimitation for the DNA taxonomy of undescribed insects. Systematic
Biology 55:595-609, doi: 10.1080/10635150600852011.

Reid NM & Carstens BC. 2012. Phylogenetic estimation error can decrease
the accuracy of species delimitation: a Bayesian implementation of the
general mixed Yule-coalescent model. BMC Evolutionary Biology 12:196,
doi: 10.1186/1471-2148-12-196.

## Citation

de Magalhães RF, Santos MTT & Camargo A. 2024. Subsampling GMYC (sGMYC):
a new algorithmic implementation of the generalized mixed
Yule-coalescent model. I Congresso Brasileiro de Biologia Evolutiva,
Curitiba, Brasil.
